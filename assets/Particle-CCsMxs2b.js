import{r as y}from"./math-BLsufJHS.js";const r={kiku:{friction:.93,gravity:.04,decayMin:.005,decayMax:.011,maxHistory:12,lineWidth:2.5},willow:{friction:.95,gravity:.06,decayMin:.0025,decayMax:.0055,maxHistory:20,lineWidth:1},botan:{friction:.92,gravity:.05,decayMin:.008,decayMax:.016,maxHistory:4,lineWidth:1.5},piano:{friction:.9,gravity:.03,decayMin:.011,decayMax:.02,maxHistory:8,lineWidth:1.5}},o={SKY_GRADIENT_TOP:"#020514",SKY_GRADIENT_BOTTOM:"#182042",WATER_HEIGHT_RATIO:.2,REFLECTION_ALPHA:.3};class d{x;y;vx=0;vy=0;alpha=1;color;type;friction;gravity;decay;history=[];maxHistory;lineWidth;constructor(i,h,s,t,l){this.x=i,this.y=h,this.color=s,this.type=t;const a={...r[t],...l};this.friction=a.friction,this.gravity=a.gravity,this.decay=y(a.decayMin,a.decayMax),this.maxHistory=a.maxHistory,this.lineWidth=a.lineWidth}get isAlive(){return this.alpha>0}update(){this.history.push({x:this.x,y:this.y}),this.history.length>this.maxHistory&&this.history.shift(),this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.x+=this.vx,this.y+=this.vy,this.alpha-=this.decay}draw(i,h){const s=Math.max(0,this.alpha);if(i.globalAlpha=s,this.history.length>1){i.beginPath(),i.moveTo(this.history[0].x,this.history[0].y);for(let t=1;t<this.history.length;t++)i.lineTo(this.history[t].x,this.history[t].y);i.lineTo(this.x,this.y),i.strokeStyle=this.color,i.lineWidth=this.lineWidth,i.stroke()}else i.fillStyle=this.color,i.beginPath(),i.arc(this.x,this.y,this.type==="willow"?1.5:2,0,Math.PI*2),i.fill();this.type==="willow"&&Math.random()>.8&&(i.fillStyle="#fff",i.beginPath(),i.arc(this.x,this.y,1,0,Math.PI*2),i.fill()),this.drawReflection(i,h)}drawReflection(i,h){const s=h*(1-o.WATER_HEIGHT_RATIO);if(this.y<s){const t=s+(s-this.y);t<h&&(i.globalAlpha=Math.max(0,this.alpha)*o.REFLECTION_ALPHA,i.fillStyle=this.color,i.beginPath(),i.arc(this.x,t,this.type==="willow"?1.5:2,0,Math.PI*2),i.fill())}}setVelocity(i,h){this.vx=i,this.vy=h}setColor(i){this.color=i}}export{d as P,o as V};
