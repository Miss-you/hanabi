var v=Object.defineProperty;var y=(s,e,t)=>e in s?v(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var f=(s,e,t)=>y(s,typeof e!="symbol"?e+"":e,t);import{r as k}from"./math-CmfUW7_Q.js";import{F as x}from"./Firework-bLsaGrCq.js";import"./Particle-BIbDLJ2h.js";class S{constructor(){f(this,"panels",new Map);f(this,"loop",()=>{requestAnimationFrame(this.loop);for(const e of this.panels.values())this.updatePanel(e),this.drawPanel(e)});this.initPanels(),this.loop()}initPanels(){document.querySelectorAll(".firework-panel").forEach(t=>{var d,o,c,p;const a=t.getAttribute("data-type"),r=t.querySelector(".preview-canvas"),i=r.getContext("2d");if(!i)return;const h=r.getBoundingClientRect(),n=window.devicePixelRatio||1;r.width=h.width*n,r.height=h.height*n,i.scale(n,n);const l={canvas:r,ctx:i,particles:[],fireworks:[],type:a,params:{count:parseInt(((d=t.querySelector('[data-param="count"]'))==null?void 0:d.value)||"100"),speed:parseInt(((o=t.querySelector('[data-param="speed"]'))==null?void 0:o.value)||"5"),gravity:parseFloat(((c=t.querySelector('[data-param="gravity"]'))==null?void 0:c.value)||"0.05")}};this.panels.set(a,l),(p=t.querySelector(".launch-btn"))==null||p.addEventListener("click",()=>{this.launchFirework(a)}),t.querySelectorAll("input[data-param]").forEach(w=>{w.addEventListener("input",m=>{const g=m.target,u=g.getAttribute("data-param");u&&u in l.params&&(l.params[u]=parseFloat(g.value))})})})}launchFirework(e){const t=this.panels.get(e);if(!t)return;const a=t.canvas.getBoundingClientRect(),r=a.width/2,i=a.height*.3,h=k(0,360),n=new x(r,i,e,h,a.height,a.width,{onExplode:l=>{l.forEach(o=>{const c=Math.atan2(o.vy,o.vx),p=Math.sqrt(o.vx*o.vx+o.vy*o.vy)*(t.params.speed/5);o.vx=Math.cos(c)*p,o.vy=Math.sin(c)*p});const d=l.slice(0,t.params.count);t.particles.push(...d)}},.5);t.fireworks.push(n)}updatePanel(e){for(let t=e.fireworks.length-1;t>=0;t--){const a=e.fireworks[t];a.update(),a.dead&&e.fireworks.splice(t,1)}for(let t=e.particles.length-1;t>=0;t--){const a=e.particles[t];a.update(),a.isAlive||e.particles.splice(t,1)}}drawPanel(e){const{ctx:t,canvas:a}=e,r=a.getBoundingClientRect();t.globalAlpha=1,t.fillStyle="#000",t.fillRect(0,0,r.width,r.height),t.fillStyle="rgba(0, 5, 20, 0.2)",t.fillRect(0,0,r.width,r.height),t.globalCompositeOperation="lighter";for(const i of e.fireworks)i.draw(t);for(const i of e.particles)i.draw(t,r.height);t.globalCompositeOperation="source-over"}}new S;
