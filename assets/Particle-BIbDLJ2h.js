var e=Object.defineProperty;var n=(o,i,h)=>i in o?e(o,i,{enumerable:!0,configurable:!0,writable:!0,value:h}):o[i]=h;var t=(o,i,h)=>n(o,typeof i!="symbol"?i+"":i,h);import{r as f}from"./math-CmfUW7_Q.js";const d={kiku:{friction:.93,gravity:.04,decayMin:.005,decayMax:.011,maxHistory:12,lineWidth:2.5},willow:{friction:.95,gravity:.06,decayMin:.0025,decayMax:.0055,maxHistory:20,lineWidth:1},botan:{friction:.92,gravity:.05,decayMin:.008,decayMax:.016,maxHistory:4,lineWidth:1.5},piano:{friction:.9,gravity:.03,decayMin:.011,decayMax:.02,maxHistory:8,lineWidth:1.5}},y={SKY_GRADIENT_TOP:"#020514",SKY_GRADIENT_BOTTOM:"#182042",WATER_HEIGHT_RATIO:.2,REFLECTION_ALPHA:.3};class M{constructor(i,h,a,s,r){t(this,"x");t(this,"y");t(this,"vx",0);t(this,"vy",0);t(this,"alpha",1);t(this,"color");t(this,"type");t(this,"friction");t(this,"gravity");t(this,"decay");t(this,"history",[]);t(this,"maxHistory");t(this,"lineWidth");this.x=i,this.y=h,this.color=a,this.type=s;const l={...d[s],...r};this.friction=l.friction,this.gravity=l.gravity,this.decay=f(l.decayMin,l.decayMax),this.maxHistory=l.maxHistory,this.lineWidth=l.lineWidth}get isAlive(){return this.alpha>0}update(){this.history.push({x:this.x,y:this.y}),this.history.length>this.maxHistory&&this.history.shift(),this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.x+=this.vx,this.y+=this.vy,this.alpha-=this.decay}draw(i,h){const a=Math.max(0,this.alpha);if(i.globalAlpha=a,this.history.length>1){i.beginPath(),i.moveTo(this.history[0].x,this.history[0].y);for(let s=1;s<this.history.length;s++)i.lineTo(this.history[s].x,this.history[s].y);i.lineTo(this.x,this.y),i.strokeStyle=this.color,i.lineWidth=this.lineWidth,i.stroke()}else i.fillStyle=this.color,i.beginPath(),i.arc(this.x,this.y,this.type==="willow"?1.5:2,0,Math.PI*2),i.fill();this.type==="willow"&&Math.random()>.8&&(i.fillStyle="#fff",i.beginPath(),i.arc(this.x,this.y,1,0,Math.PI*2),i.fill()),this.drawReflection(i,h)}drawReflection(i,h){const a=h*(1-y.WATER_HEIGHT_RATIO);if(this.y<a){const s=a+(a-this.y);s<h&&(i.globalAlpha=Math.max(0,this.alpha)*y.REFLECTION_ALPHA,i.fillStyle=this.color,i.beginPath(),i.arc(this.x,s,this.type==="willow"?1.5:2,0,Math.PI*2),i.fill())}}setVelocity(i,h){this.vx=i,this.vy=h}setColor(i){this.color=i}}export{M as P,y as V};
